{{#partial "page"}}
<div id="page-content-wrapper"  class="">
	<div class="container-fluid">
	<div class="col-md-12">
			<div class="row log-table-head dd-log-head">
				<div class="lth-left">
					<span>VENUE</span>		
				 <i class="fa fa-angle-right" aria-hidden="true"></i>
					<span title="{{sitename}}"><div id="sname"></div></span>	
				<i class="fa fa-angle-right" aria-hidden="true"></i>	
					<span>
					<select class="form-control display-inline" id="floorName">	
					<option value="{{id}}" hidden = "true">{{portionname}}</option>
					{{#each portion}}			
					<option value="{{id}}">{{uid}}</option>
					{{/each}}
				</select>
				</span>
				</div>
				<div class="lth-right searchTAG pull-right" style="margin-right: 5px">
					<div class="lth-right searchUID">
					<div class="search-opt">
						<form action="/facesix/web/site/portion/devboard" id="target">
							<div class="form-group">
								<div class="search-box">
									<span class="icon" id="searchClick">
										<i class="fa fa-search " aria-hidden="true"></i>
									</span>
									<input type="hidden" name="sid" value="{{sid}}">
									<input type="hidden" name="cid" value="{{cid}}">
									<input type="hidden" name="spid" value="{{spid}}">
									<input type="hidden" name="param" value="{{param}}">
									<input type="hidden" name="place" value="gatewayfloor">
									<input type="search" name = "uid" id="uid" class="form-control search-align" placeholder="" onkeyup="doInsert(this);" maxlength="17">
								</div>
							</div>
						</form>
					</div>
					</div>
				</div>
			</div>
		</div>
		<div class="uitag-card uitag-card-Qfloor">
			<div class="row">
				<div class="col-md-3 col-sm-6">
					<div class="ui-card">
						<i class="fa fa-wifi"></i>
						 <h2 id="demo-pie-2">0</h2>
						 <h4>Device(s) Deployed</h4>
					</div>
				</div>	
			<div class="col-md-3 col-sm-6">
					<div class="ui-card">
						<i class="fa fa-user" style="background-color: rgb(150, 200, 100)"></i>
						 <h2 id="piechart1">0</h2>
						 <h4>Associated Clients 2G</h4>
					</div>
				</div>	
				<div class="col-md-3 col-sm-6">
					<div class="ui-card">
						<i class="fa fa-user" style="background-color: rgb(64, 224, 208)"></i>
						 <h2 id="piechart3">0</h2>
						 <h4>Associated Clients 5G</h4>
					</div>
				</div>	
				<div class="col-md-3 col-sm-6"> 
					<div class="ui-card ui-card-chart">
						 <div id="fd_chart_client"></div>
						 <h4>Clients Connected</h4>
					</div>
				</div>
			</div>
		</div>
		
		<!-- <div class="col-md-3 floorChartLine padmob-10 floordash-col padding-right-0">
			<div class="card-box fd-card">
				<div class="cb-center">
					<div class="circle-chart">
						<div id="demo-pie-2" class="progress"></div>
					</div>
				</div>
				<div class="cb-caption">
					<label>Device(s) Deployed</label>
				</div>
			</div>
		</div> 
		   <div class="col-md-3 floorChartLine padmob-10 floordash-col padding-right-0">
			<div class="card-box">
				<div class="cb-caption">
					<label>Active Clients (2G vs 5G)</label>
				</div>
				<div class="chart1Section text-center margin-top-20">
					<div id="piechart1" class="chart-style"></div>
				</div>
			</div>
		</div> 
		
		<div class="col-md-3 floorChartLine padmob-10 floordash-col padding-right-0">
			<div class="card-box">
				<div class="cb-caption">
					<label>Clients Connected </label>
				</div>
				<div class="chart1Section text-center margin-top-20">
					<div id="fd_chart4" class="chart-style"></div>
				</div>
			</div>
			</div>
		</div> -->
	<!--	<div class="col-md-3 floorChartLine padmob-10 floordash-col padding-right-0">
			<div class="card-box">
				<div class="cb-caption">
					<label>Avg Downlink Speed</label>
				</div>
				<div class="cb-center cbt-center">
					<div id="downchart"></div>
				</div>
			</div>
		</div>
		<div class="col-md-3 floorChartLine padmob-10 floordash-col padding-right-0">
			<div class="card-box">
				<div class="cb-caption">
					<label>Avg Uplink Speed</label>
				</div>
				<div class="cb-center cbt-center">
					<div id="upchart"></div>
				</div>
			</div>
		</div>
		-->
		<div class="col-lg-12">
			<div class="recent-Overview">
				<div class="networkAct display-inline">
					<label>Network Activity</label>
				</div>
				
			</div>
		</div>
		<div class="col-lg-12 floorCanvas padmob-10 floordash-col" style="margin-bottom: 20px;">
			<div class="panel panel-default na-panel" style="height:536px;">
				<div class="panel-heading">
					<ul class="list-unstyled margin-btm-0">
						<li class="tagsfilters" style="top: -4px; position: relative;">
							
							<div class="onoffswitch ">
						  	    <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="clientsONOFF" checked="true">
							    <label class="onoffswitch-label" for="clientsONOFF">
							        <span class="onoffswitch-inner"></span>
							        <span class="onoffswitch-switch"></span>
							    </label>
							</div>
							<div class="onoffswitch onoffswitch-m">
						  	    <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="twoGONOFF" checked="true">
							    <label class="onoffswitch-label" for="twoGONOFF">
							        <span class="onoffswitch-inner bg-color"></span>
							        <span class="onoffswitch-switch"></span>
							    </label>
							</div>
							<div class="onoffswitch onoffswitch-m">
						  	    <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="fiveGONOFF" checked="true">
							    <label class="onoffswitch-label" for="fiveGONOFF">
							        <span class="onoffswitch-inner bg-colr"></span>
							        <span class="onoffswitch-switch"></span>
							    </label>
							</div> 
							
						 </li>
						 
						<li class="pull-right enlarge">
								<img src="/facesix/static/qubercomm/images/flooroverview/expand.png" alt="">
						</li>
					</ul>
					<div class="clearfix"></div>
				</div>
				<div class="zoomOptionsInner">
					<a href="javascript:void(0)" id="zoom-in"><img src="/facesix/static/qubercomm/images/zoom-in.png" /></a> 
					<a href="javascript:void(0)" id="zoom-out"><img src="/facesix/static/qubercomm/images/zoom-out.png" /></a> 
					<a href="javascript:void(0)" id="reset"><img src="/facesix/static/qubercomm/images/reset.png" /></a> 
				</div>
				<div class="panel-body floorsvgCont">
				<div class="mapping-section" style="overflow: hidden; position: relative;">
					<!--  <div class="slider-section" style="margin-left: -15px;">
						<div class="slider">
							<label class="enlarge">
								<img src="/facesix/static/qubercomm/images/networkconfig/full.png" id="fullscreen" alt="">
							</label>
							<label>
								<img src="/facesix/static/qubercomm/images/networkconfig/plus.png" class="minus zoom-in" alt="">
							</label>
							<input type="range" class="zoom-range" min="0" max="3" step="1.0">
							<label style="margin-top: 154px;">
								<img src="/facesix/static/qubercomm/images/networkconfig/minus.png" class=" zoom-out" alt="">
							</label>
						</div>
					</div>
					-->
					<!-- <div class="leftSec pull-left"></div> -->
					<div class="maping-canvas" id="main-div" style="height:auto">
						<div class="canvas-container">
							<svg  class="floorsvg" id="plan">
								<g class="uiFloorGroupOuter"  transform="translate(0,0)" >
					 
								</g> 
				    		</svg>
						</div>
					</div>
					
				</div>
				    
				</div>
			</div>
		</div>
		
		<div class="col-md-4 flooraddCommon padmob-10 floordash-col">
			<div class="chart-box fd-chartbox height summaryTable">
			</div>
		</div>
		<!-- <div class="col-md-4 flooraddCommon padmob-10 floordash-col" style="display: none;">
			<div class="chart-box fd-chartbox height">
				<div class="netflowData select-filter-Plan venue-filter">
					<label>Radio vs Traffic</label>
					<div class="select-filter-Plan display-inline pull-right">
						<select style="margin-top: -7px;margin-right: 5px;" class="form-control display-inline selectTime" data-action="/netflow">
							<option selected="" value="5">Last 5 Minutes </option>
							<option value="15">15 Minutes </option>
							<option value="30">30 Minutes </option>
							<option value="60">60 Minutes </option>
							<option value="120">120 Minutes </option>
						</select>
					</div>
				</div>
				<div class="cb-section">
					<div class="chart1">
						<div class="chart1Section">
							<div id="vdChart1"></div>
						</div>
					</div>
				</div>
			</div>			
		</div> -->
		<div class="fullActive col-md-8 vdcol-8 padremovecol venue-col">
		<div class="chart-box fd-chartbox height">
				<div class="cb-section">
					<div class="chart1">
					<div class="netflowData select-filter-Plan venue-filter">
						<label>AVG Network Traffic</label>
					</div>
						<!-- <div class="select-filter-Plan venue-filter">
							<select class="txrxswap">
								<option selcted>Avg Downlink/Uplink Speed</option>
								<option value="Tx">Avg Uplink Speed</option>
								<option value="Rx">Avg Downlink Speed</option>
							</select>
						</div> -->
						<div class="chart1Section">
							<div id="fd_chart2"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!--  <div class="col-md-4 flooraddCommon padmob-10 floordash-col padding-left-0">
			<div class="chart-box fd-chartbox height">
				<div class="device-coon-desc">
					<label>Clients Connected </label>
				</div>
				<div class="chart1Section text-center margin-top-20">
					<div id="fd_chart4" class="chart-style"></div>
				</div>
			</div>
		</div>
		<div class="col-md-4 flooraddCommon padmob-10 floordash-col pad0">
			<div class="chart-box fd-chartbox height">
				<div class="device-coon-desc">
					<label>Active Clients (2G vs 5G)</label>
				</div>
				<div class="chart1Section text-center margin-top-20">
					<div id="piechart1" class="chart-style"></div>
				</div>
			</div>
		</div> -->
	</div>
</div>
<div class="networkconfig" id="submenu-modal" style="display:none">
	<div class="network-popHeading">
		<label id="deviceHeading"></label>
		<span class="pull-right">
			<a href="#" onclick="javascript:$('#submenu-modal').hide();"><img src="/facesix/static/qubercomm/images/networkconfig/close.png"></a>
		</span>
	</div>
	<div class="netRoute">
		<span id="status"></span>
	</div>
	<ul>
		<li>
			<label>
				<a href="#" class="powerBtn" action="Reboot">
					<i class="fa fa-power-off"></i>
					<span>Restart</span>
				</a>
			</label>
			<label>
				<a href="#" class="viewActivity">
					<img src="/facesix/static/qubercomm/images/networkconfig/activity.png">
					<span>View Activity</span>
				</a>
			</label>
		</li>
	</ul>
</div>
<div class="savearea" style="display:none;position:fixed">
<div class="savearea_bottom">
			<div class="left-section">
				<label>Are you sure you want to delete the Floor?</label>
			</div>
			<div class="rightsection">
				<ul class="list-unstyled">
					<li id="cancelDelete">
						<label>
							
						</label>
						<span >
							Cancel
						</span>
					</li>
					<li id="deleteItem">
						<label>
						</label>
						<span class="color2" >
							OK
						</span>
					</li>
				</ul>
			</div>
			</div>
</div>


<!--css-->
<link rel="stylesheet" type="text/css" href="/facesix/static/qubercomm/css/c3.css"/>
<link rel="stylesheet" type="text/css" href="/facesix/static/qubercomm/css/circularprogress.css"/>
<!--#css-->
<!-- js -->	
<script src="/facesix/static/qubercomm/js/jquery-2.1.4.min.js" type="text/javascript"></script>
<script src="/facesix/static/qubercomm/js/bootstrap.min.js" type="text/javascript"></script>
<script type="text/javascript" src="/facesix/static/qubercomm/js/jquery.nicescroll.min.js"></script>
<script src="/facesix/static/qubercomm/js/circularprogress.jquery.min.js"></script>
<script type="text/javascript" src="/facesix/static/qubercomm/js/snap.svg-min.js"></script>
<script type="text/javascript" src="/facesix/static/finder/js/svg-panzoom.js"></script>
<script type="text/javascript" src="/facesix/static/qubercomm/js/snap.svg-min.js"></script>
<script type="text/javascript" src="/facesix/static/qubercomm/js/d3.min.js"></script>
<script type="text/javascript" src="/facesix/static/qubercomm/js/c3.js"></script>
<script type="text/javascript" src="/facesix/static/qubercomm/js/handlebars.min.js"></script>
<script type="text/javascript" src="/facesix/static/qubercomm/js/floordashboard.js"></script>
<script type="text/javascript" src="/facesix/static/qubercomm/js/script.js"></script>
<style>
#fd_chart_client .c3-tooltip-container{
    overflow: visible;
}
.hidiv { position:absolute; top:700px; padding:5px 10px; background-color: rgba(255, 255, 255, 0.8); color:#4285f4; display:none;
 border:1px solid #ccc; font-size:12px;z-index:9999; }
 .panel-default>.panel-heading { height:40px;}
 .selectag { border:none; background:#fbfbfb; outline:none;} 
 .slider label .plus { width:20px; height:20px; margin-left:-10px;}
 .mapping-section { height:100%; border:none;}
 .na-panel a{cursor:pointer; }
 .floorCanvas{width: 100%;position: relative;float:left;}
 #main-div{
	height: auto !important;
}
.floorCanvas.deviceexpand{
	position: fixed;
}
.onoffswitch-m{
	-moz-transition: .5s;
	-webkit-transition: .5s;
	transition: .5s;
}
.tagsfilters.active .onoffswitch-m{
	visibility: hidden;
	opacity: 0;
}
.bg-color:before {
	background-color: rgb(150, 200, 100) !important; 
	font-weight: bold;
}
.bg-colr:before{
	background-color: rgb(64, 224, 208) !important;
	font-weight: bold;
}
.person.tagdisables {
    visibility: hidden;
    opacity: 0;
}
@media screen and (max-width: 480px){
	.col-md-12{
	position: static;
	padding-left: 0;
	padding-right: 0;
	}
	.panel-body {
    padding: 29px 0px;
    margin: -20px 0px 0px 0px;
}
}
@media screen and (min-width: 481px) and (max-width: 768px){
	.col-md-12{
	position: initial;
	
	}	
}
</style>
<script id="alerts-template" type="text/x-handlebars-template">
    <div>
        <div class="recent-heading">
            <ul class="list-unstyled margin-btm-0">
                <li class="dropdown profile-dash">
                    Alerts
                </li>
            </ul>
        </div>
        <div class="recentDataSection scrollbar-inner" tabindex="0" style="overflow: hidden; outline: none;">
			\{{#each alerts}}
				<div class="recent-venue">
					<div class="recent-data">
						<p>
							<label>\{{description}}</label>
						</p>
						<label class="pull-right venue-time">\{{count}}</label>
					</div>
				</div>
			\{{/each}}
        </div>
    </div>
</script>	
<script>
	var str = '{{sitename}}'; 
	if (str.length > 32) {
		str = str.substr(0, 32)
		str += "...";
	}
	
	document.getElementById("sname").innerHTML = str; 

	var str = '{{fsobject.uid}}';
	 
	if (str.length > 16) {
		str = str.substr(0, 16)
		str += "...";
	}
	
	document.getElementById("flname").innerHTML = str; 
</script>
	
<script type="text/javascript">

	$(document).ready(function(){
		
		solutionInfo('{{Gateway}}', '{{GeoFinder}}','{{Heatmap}}','{{GatewayFinder}}');
		
		var url = "url('/facesix/web/site/portion/planfile?spid=" + '{{spid}}'
		url 	= url +   "') no-repeat"
		
		// $('#plan').html("");
		// $('#plan').style = url;
		// $('#plan').css ('background', url);
		$('#plan').css ('width', 	 '{{width}}');
		$('#plan').css ('height',    '{{height}}');
		 
		var imagePath = "/facesix/web/site/portion/planfile?spid={{spid}}";
	 	
		var svgNew = d3.select('svg.floorsvg').selectAll('.uiFloorGroupOuter');
		
		var svgMap = d3.select("svg.floorsvg").selectAll('.uiFloorGroupOuter');
		var imageFound = document.getElementById('bgImage');
		if(imageFound == null){
			var newImage=svgNew.insert("image")
		    .attr({
		        'x':0,
		        'y':0,
		        'xlink:href':imagePath, 
		        'height': '{{height}}',
		        'width':'{{width}}',
		        'id': 'bgimage'
		    }); 
		    
		}
		
		var width = '{{width}}';
		var uiFloorWrpWidth = $('.canvas-container').innerWidth();
	    var twidth = (uiFloorWrpWidth - width)/2;
	    if(twidth > 0){
	    	svgNew.attr('transform', 'translate(' +twidth+ ',10)'); 
	    }
	     
	    $('.enlarge').click(function(){
	    	
	    	var svgNew = d3.select('svg.floorsvg').selectAll('.uiFloorGroupOuter');
	        var uiFloorWrpWidth = $('.canvas-container').innerWidth();
	        var twidth = (uiFloorWrpWidth - width)/2;
	        if(twidth > 0){
	        	svgNew.attr('transform', 'translate(' +twidth+ ',10)'); 
	        }
	    });
	    $('#bgimage').load(function() { 
	    }); 
	    
	    var beforePan
	    beforePan = function(oldPan, newPan){ 
	    	var	zoom = this.getSizes().realZoom; 
	    	zoom = zoom /5;
	    	gutterWidth = 100 * zoom;
	      var stopHorizontal = false
	       , sizes = this.getSizes()
	        , stopVertical = false 
	        , gutterHeight = 100
	          // Computed variables
	       
	        , leftLimit = -((sizes.viewBox.x + sizes.viewBox.width) * sizes.realZoom) + gutterWidth  
	        , rightLimit = sizes.width - gutterWidth - (sizes.viewBox.x * sizes.realZoom) 
	        , topLimit = -((sizes.viewBox.y + sizes.viewBox.height) * sizes.realZoom) + gutterHeight
	        , bottomLimit = sizes.height - gutterHeight - (sizes.viewBox.y * sizes.realZoom)
	      customPan = {}
	      customPan.x = Math.max(leftLimit, Math.min(rightLimit, newPan.x))
	      customPan.y = Math.max(topLimit, Math.min(bottomLimit, newPan.y))
	      return customPan
	    }
	    var panZoom;
	    window.initialize = function () {
	    	 panZoom = svgPanZoom('#plan', {
				zoomEnabled: true,
				zoomScaleSensitivity: .2,
				minZoom: 1,
				maxZoom: 100,
				panEnabled: true,
				contain: false,
				controlIconsEnabled: false,
			    fit: false,
			    center: false,  
			    beforePan: beforePan,
				onZoom: function(e){ 
					floorChange(e);
				}
			});
	    }
	    initialize();
		document.getElementById('zoom-in').addEventListener('click', function(ev){
		    ev.preventDefault()
		    panZoom.zoomIn()
		});
		document.getElementById('zoom-out').addEventListener('click', function(ev){
		    ev.preventDefault()
		    panZoom.zoomOut()
		   
		});
		document.getElementById('reset').addEventListener('click', function(ev){
		    ev.preventDefault()  
		    panZoom.destroy();
		    initialize();
		});
		
	     
		
		function floorChange(e){
			var circleRadius = 10;
			var fSize = 10;
			fnsize = (10/e)+3; 
			circleRadius = (10/e)+3; 
			var newSize = e/3; 
			var cyposition = 9;
			var image = d3.select("svg.floorsvg").selectAll(".animatedImage");
			if(newSize >= 20){
				image.attr('width', '3px')
				 .attr('height', '3px'); 
			}  
			else if(newSize >= 15){
				image.attr('width', '6px')
				 .attr('height', '6px'); 
			}
			else if(newSize >= 10){
				image.attr('width', '8px')
				 .attr('height', '8px'); 
			}
			else if(newSize >= 5){
				image.attr('width', '10px')
				 .attr('height', '10px'); 
			}
			else if(newSize >= 3){
				image.attr('width', '15px')
				 .attr('height', '15px'); 
			}
			else if(newSize >= 1){
				image.attr('width', '20px')
				 .attr('height', '20px'); 
			}
			else if(newSize >= .5){
				image.attr('width', '20px')
				 .attr('height', '20px'); 
			}
			else if(newSize >= .3){
				image.attr('width', '40px')
				 .attr('height', '40px'); 
			}
			else{
				image.attr('width', '40px')
				 .attr('height', '40px'); 
			}	
			 
			if(newSize >= 20){
				fnsize=1;
				cyposition = .3;
			} 
			else if(newSize >= 10){
				fnsize=2;
				cyposition = .8;
			}
			else if(newSize >= 5){
				fnsize=3;
				cyposition = 1;
			}
			else if(newSize >= 2){
				fnsize=6;
				cyposition = 2;
			}
			else if(newSize >= 1){
				fnsize=8;
				cyposition = 3;
			}
			else if(newSize >= .5){
				fnsize = 15;
				cyposition = 5;
			} 
			else{
				fnsize = 30;
				cyposition = 9;
			} 
			 
			fzie = fnsize;
			txty = cyposition;
			var circle = d3.select("svg.floorsvg").selectAll("circle");
			circle.attr('r', fnsize);
			var txt = d3.select("svg.floorsvg").selectAll("text");
			txt.attr('font-size', fnsize+'px');
			txt.attr('y', cyposition);
		}
		
        var t1 = '{{Gateway}}';
		var t2 = '{{GeoFinder}}';
		var t3 = '{{GatewayFinder}}';
        
	    floornetworkConfig.svg = d3.select("svg.floorsvg").selectAll('.uiFloorGroupOuter');
	    floornetworkConfig.getDevices(t1,t2,t3);
	  
	    /* $(document).on("mouseenter", ".person", function(e) {
	    	
	    	$('.hidiv').html($( this ).attr("info")).css({ 'top' : (event.pageY-50) + 'px', 'left' : (event.pageX-50) + 'px'}).show();
	    });
	
	    $(document).on("mouseleave", ".person", function(e) {
	    	$('.hidiv').html('').hide();
	    });
	    
	    */
	    
	})

	FloorDashboard.init();
</script>
{{/partial}}

{{>qubercomm/nav-top}}
{{>qubercomm/nav-left}}
{{>qubercomm/wrapper}}