{{#partial "page"}}
<style>
.selected{ 
background-color: rgba(211,211,211,.7);
color: black;
}
table{
cursor: default;
}
</style>
<div id="page-content-wrapper">
	<div class="container-fluid">
		<div class="col-md-12 padding-right-0">
			<div class="row log-table-head dd-log-head">
				<div class="lth-left mob-nm" style="float: none;">
					<i class="fa fa-bluetooth fa-lg" style="color:green"></i>	
					
					{{#if spid}}
						<span title="{{sitename}}"><div id="sname"></div></span>
						<i class="fa fa-angle-right" aria-hidden="true"></i>	
						<span title="{{portionname}}"><div id="flname"></div></span>	
						<span><i class="fa fa-angle-right" aria-hidden="true"></i> BLE-{{alias}}</span>
					{{else}}
						<span>BLE <i class="fa fa-angle-right" aria-hidden="true"></i> BLE-{{alias}}</span>
					{{/if}}																
					<div class="GeneratePdf aln-cu">
					<div class="upd">
						<button class="btn btn-sm toggleBtns collapsed " title="CPU/APP Uptime" style="background: none;background: none; position: relative;" data-toggle="collapse" data-target="#togglePdfGen"><i class="fa fa-heartbeat heartbeat animate-infinite-heartbeat" aria-hidden="true"></i></button>
					</div>
						<div class="downd" style="display: inline-block;">
							<div class="collapse fade" id="togglePdfGen" >
								<ul class="deviceUptime" id="deviceUptime">
									<li><span>CPU Uptime :</span> <i>Days: 0, Hours: 0, Min: 0</i></li><li><span>APP Uptime :</span> <i>Days: 0, Hours: 0, Min: 0</i></li>
								</ul>
								<div class="clearfix"></div>
							</div>
						</div>
						
						
					</div>
				</div>
				
			</div>
		</div>
		<div class="col-md-3 devicecol-3 device-col padding-device padding-right-0">
			<div class="card-box fd-card">
				<div class="cb-center">
					<div class="chart1Section text-center">
						<div id="dd-chart1" class="chart-style"></div>
					</div>
				</div>
				<div class="cb-caption">
					<label>Connected Interfaces</label>
				</div>
			</div>
		</div>
	
		<div class="col-md-3 devicecol-3 device-col padding-device padding-right-0">
			<div class="card-box ble-card">
				<div class="cb-center">
					<div class="circle-chart">
						<div id="dd-chart2" class="progress"></div>
					</div>
				</div>
				<div class="cb-caption">
					<label>Active Tags</label>
				</div>
			</div>
		</div>
		
			
		<div class="col-md-3 devicecol-3 device-col padding-device padding-right-0">
			<div class="card-box">
				<div class="cb-caption">
					<label>CPU Utilization</label>
				</div>
				<div class="cb-center cbt-center">
					<div id="downchart"></div>
				</div>
			</div>
		</div>
		<div class="col-md-3 devicecol-3 device-col padding-device padding-right-0">
			<div class="card-box">
				<div class="cb-caption">
					<label>Memory Utilization</label>
				</div>
				<div class="cb-center cbt-center">
					<div id="upchart"></div>
				</div>
			</div>
		</div>
		<div class="col-md-12 padding-right-0">
			<div class="recent-Overview">
				<div class="networkAct display-inline">
					<label>BLE Tags Activity</label>
				</div>
			</div>
		</div>
		<div class="col-md-6 devicecol-6 device-col padding-device padding-right-0">
			<div class="chart-box venus-chart1 fd-chartbox height">
				<div class="cb-section">
					<div class="chart1">
						<div class="select-filter-Plan venue-filter">
							<select class="txrxswap">
								<option selcted>Uplink/Downlink Avg. Bytes</option>
								<option value="Uplink">Uplink Avg Bytes</option>
								<option value="Downlink">Downlink Avg Bytes</option>
							</select>
						</div>
						<div class="chart1Section">
							<div id="fd_chart2"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="col-md-6 devicecol-6 device-col padding-device padding-right-0">
			<div class="chart-box fd-chartbox height">
				<div class="device-coon-desc">
					<label>Active Tag Types </label>
				</div>
				<div class="chart1Section text-center">
					<div id="dd-chart5" class="chart-style"></div>
				</div>
			</div>
		</div>
		
	
		 <!-- <div class="col-md-6 devicecol-6 device-col padding-device padding-right-0">
			<div class="chart-box fd-chartbox height">
				<div class="cb-center">
					<div class="chart1Section text-center">
						<div id="dd-chart2" class="chart-style"></div>
					</div>
				</div>
				<div class="cb-caption">
					<label>Active BLE Tags</label>
				</div>	
				
			</div>
		</div>  -->
		
		<div class="col-md-12 padding-device padding-right-0 tableHide">
			<div class="chart-box table-chart-box"></div>
		</div>
			
	</div>
</div>
<div class="pad0 col-sm-3 col-md-3 sidebar  LogsSection inactive" id="rightPanel">
	<div class="network-map-section logMapSection">
		
		<div class="network-top-section">
			<div class="search-opt">
				<!-- <form id="uidForm"> -->
					<div class="form-group">
						<div class="serach-box">
							<span class="icon">
								<i class="glyphicon glyphicon-search"></i>
							</span>
							<input type="search" class="form-control search-align" placeholder="Search Devices...">
						</div>
					</div>
				<!-- </form> -->
			</div>
			<div class="network-heading display-inline hide">
				<label>Network Tree</label>
			</div>
			<div class="filter-opt display-inline pull-right">
				<ul class="list-unstyled filter-opt-style">
					<li class="search-mob-hide hide">
						<img src="/facesix/static/qubercomm/images/networkconfig/search.png" class="search-icon" alt="">
						Search
					</li>
					<li class="dropdown filter-dropdown">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="true">
							<img src="/facesix/static/qubercomm/images/networkconfig/filter.png" alt="">
							Filter
							<span class="caret"></span></a>
							<ul class="dropdown-menu filter-style">
								<li><a href="#">Switch</a></li>
								<li><a href="#">AP</a></li>
								<li><a href="#">Sensor</a></li>
							</ul>
						</li>
					</ul>
				</div>
			</div>
			<div class="device-section">
				<span>
					0 Devices
				</span>
				<ul class="list-unstyled">
					<li>
						<a href="" class="dshbrdLink">
							<i class="fa fa-bar-chart" style="color:lightgray"></i>
						</a>
					</li>
					{{#if BINARY_WRITE}}
						<li class="addhide">
								<a href="" class="binaryLink">
								 <i class="fa fa-cloud-download" style="color:lightgray"></i>			
								</a>
							</li>
							{{/if}}
					{{#if SYS_WRITE}}
					<li class="addhide">
						<a href="" class="devcfgLink">
						  <i class="fa fa-cog" style="color:lightgray"></i>
						</a>
					</li>
					{{/if}}
					<!-- <li>
								<a href="" class="scanLink">
								  <i class="fa fa-rss" style="color:lightgray"></i>			
								</a>
                                           				
							</li> -->
					{{#if SYS_WRITE}}
					<li class="powerBtn" action="reset" btn-type="reset" devtype="AP" uid="{{uid}}">
						<a href="">
							<!-- <img src="/facesix/static/qubercomm/images/networkconfig/refresh.png" alt=""> -->
							<i class="fa fa-undo fa_style"></i>
						</a>
					</li>
					<li class="powerBtn" action="reboot" btn-type="reboot" devtype="AP" uid="{{uid}}">
						<a href="">
							<!-- <img src="/facesix/static/qubercomm/images/networkconfig/off.png" alt=""> -->
							<i class="fa fa-power-off fa_style"></i>
						</a>
					</li>
					{{/if}}
				</ul>
			</div>
			<div class="device-notification">
				<ul class="unstyled" id="network-tree">
				
				</ul>
			</div>
		</div>
	</div>
		
	
</div>

<div class="savearea rebootPopup" style="display:none;position:fixed">
<div class="savearea_bottom">
			<div class="left-section">
				<label>Are you sure you want to?</label>
			</div>
			<div class="rightsection">
				<ul class="list-unstyled">
					<li id="cancelDelete">
						<label>
							
						</label>
						<span >
							Cancel
						</span>
					</li>
					<li id="deleteItem">
						<label>
						</label>
						<span class="color2" >
							OK
						</span>
					</li>
				</ul>
			</div>
			</div>
</div>
<!-- js -->
<script src="/facesix/static/qubercomm/js/jquery-2.1.4.min.js" type="text/javascript"></script>
<script src="/facesix/static/qubercomm/js/bootstrap.min.js" type="text/javascript"></script>
<script type="text/javascript" src="/facesix/static/qubercomm/js/jquery.nicescroll.min.js"></script>
<script src="/facesix/static/qubercomm/js/circularprogress.jquery.min.js"></script>
<script type="text/javascript" src="/facesix/static/qubercomm/js/d3.min.js"></script>
<script type="text/javascript" src="/facesix/static/qubercomm/js/c3.js"></script>
<script type="text/javascript" src="/facesix/static/qubercomm/js/handlebars.min.js"></script>
<script type="text/javascript" src="/facesix/static/qubercomm/js/underscore-min.js"></script>
<script type="text/javascript" src="/facesix/static/finder/js/finderdevicedashboard.js"></script>
<script type="text/javascript" src="/facesix/static/finder/js/script.js"></script>
<!--css-->
<link rel="stylesheet" type="text/css" href="/facesix/static/qubercomm/css/circularprogress.css"/>
<link rel="stylesheet" type="text/css" href="/facesix/static/qubercomm/css/c3.css"/>
<!--css-->


<script id="chartbox-template" type="text/x-handlebars-template">
	<div class="device-coon-desc">
		<label>Tags Found</label>
		<span class="table-page" data-table-name="dashboard-table"><i class="fa fa-refresh refreshTable" aria-hidden="true"></i>\{{#if show_previous_button}}<i class="fa fa-caret-left tablePreviousPage"></i>\{{/if}}&nbsp;\{{#if show_next_button}}<i class="fa fa-caret-right tableNextPage"></i>\{{/if}}</span>
	</div>
	<div class="tableSection">
		<table class="table dashboard-table" id="dashboard-table" data-current-page="\{{current_page}}" data-row-limit="5">
			<thead>
				<tr class="sel_tbl1">
					<th onclick="sort_table('spotid', 0, asc1); asc1 *= -1; asc2 = 1; asc3 = 1; sel_tbl1(0)" class="width-40"># <i class="fa fa-arrow-up"></i></th>
					<th onclick="sort_table('spotid', 1, asc1); asc1 *= -1; asc2 = 1; asc3 = 1; sel_tbl1(1)">Type <i class="fa fa-arrow-up"></i></th>
					<th onclick="sort_table('spotid', 2, asc1); asc1 *= -1; asc2 = 1; asc3 = 1; sel_tbl1(2)">Tag ID <i class="fa fa-arrow-up"></i></th>
					<th onclick="sort_table('spotid', 3, asc1); asc1 *= -1; asc2 = 1; asc3 = 1; sel_tbl1(3)">Assigned To <i class="fa fa-arrow-up"></i></th>
					<th onclick="sort_table('spotid', 4, asc1); asc1 *= -1; asc2 = 1; asc3 = 1; sel_tbl1(4)">Tag Type <i class="fa fa-arrow-up"></i></th>
					<th onclick="sort_table('spotid', 5, asc1); asc1 *= -1; asc2 = 1; asc3 = 1; sel_tbl1(5)">Battery Level <i class="fa fa-arrow-up"></i></th>
                    {{#if locatum}}
					<th onclick="sort_table('spotid', 6, asc1); asc1 *= -1; asc2 = 1; asc3 = 1; sel_tbl2(6)">Range(meter) <i class="fa fa-arrow-up"></i></th>
					<th onclick="sort_table('spotid', 7, asc1); asc1 *= -1; asc2 = 1; asc3 = 1; sel_tbl2(7)">Accuracy <i class="fa fa-arrow-up"></i></th>
					{{/if}}
				</tr>
			</thead>
			<tbody id="spotid">
				\{{#each data}}
				<tr taguid="\{{taguid}}" reciverid="\{{reciverid}}" uid="{{uid}}" battery="\{{battery}}">
					<td style="color:black">\{{index}}</td>
					<td><i class="fa fa-tags" style="color:green"></i> </td>
					<td style="cursor:pointer" onclick="location.href='/facesix/web/beacon/tagDashboard?macaddr=\{{taguid}}&sid={{sid}}&spid={{spid}}&cid={{cid}}'">
					<a class="LN1 LN2 LN3 LN4 LN5">
					\{{taguid}}  
					</a>
					</td>	
					<td style="color:black">\{{assignedto}}</td>
					<td style="color:black">\{{tagtype}}</td>
					<td>
					<li> 
						<a title="\{{battery}}%"><i class="\{{fafa}}" style="color:\{{color}}"></i></a>
					</li>
					{{#if locatum}}
					<td style="color:black">\{{range}}</td>
					<td style="color:black">\{{accuracy}}</td>
					{{/if}}					
					
				</tr>
				\{{/each}}
			</tbody>
		</table>
	</div>

</script>

<script>

    	getDevices('{{Gateway}}', '{{GeoFinder}}','{{Heatmap}}','{{GatewayFinder}}');

	var str = '{{sitename}}'; 
	if (str.length > 16) {
		str = str.substr(0, 16)
		str += "...";
	}
	
	document.getElementById("sname").innerHTML = str; 

	var str = '{{portionname}}'; 
	if (str.length > 10) {
		str = str.substr(0, 10)
		str += "...";
	}
	
	document.getElementById("flname").innerHTML = str;
	function getParameterByName(name, url) {
	    if (!url) url = window.location.href;
	    name = name.replace(/[\[\]]/g, "\\$&");
	    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
	        results = regex.exec(url);
	    if (!results) return null;
	    if (!results[2]) return '';
	    return decodeURIComponent(results[2].replace(/\+/g, " "));
	}
	$(document).ready(function(){
		var uid = getParameterByName('uid');
		console.log(uid);
		$.ajax({
	        url: '/facesix/rest/beacon/ble/networkdevice/deviceupstate?uid='+uid,
	        method: "get",
	        success: function (result) {  
	        	if(result.length > 0){
	        		 var result = result[0];
	        		 if(result.cpuDays == undefined){
	        			 result.cpuDays = 0;
	        		 }
	        		 if(result.cpuHours == undefined){
	        			 result.cpuHours = 0;
	        		 }
	        		 if(result.cpuMinutes == undefined){
	        			 result.cpuMinutes = 0;
	        		 }
	        		 if(result.appDays == undefined){
	        			 result.appDays = 0;
	        		 }
	        		 if(result.appHours == undefined){
	        			 result.appHours = 0;
	        		 }
	        		 if(result.appMinutes == undefined){
	        			 result.appMinutes = 0;
	        		 }
	                 var data = '<li><span>CPU Uptime :</span> <i>Days: '+result.cpuDays+', Hours: '+result.cpuHours+', Min: '+result.cpuMinutes+'</i></li><li><span>APP Uptime :</span> <i>Days: '+result.appDays+', Hours: '+result.appHours+', Min: '+result.appMinutes+'</i></li>';
	                  $('#deviceUptime').html(data);
	        	} 
	             
	        },
	        error: function (data) {
	            setTimeout(function () {
	              DeviceDashboard.tables.setTable.activeClientsTable();
	           }, 10000);                            
	        },
	        dataType: "json"

	    });
	}); 
	


</script>
<style>
	.deviceUptime{
		display: inline-block;
		margin: 0;
		padding: 0;
	}
	.deviceUptime li{
		display: inline-block;
		list-style: none;
		padding-right: 15px;
		font-size: 14px;
	}
	.deviceUptime li span{
		font-weight: 600;
		color: #009bc2;
	}
	.deviceUptime li i{
		font-style: normal;
	    color: #2a3f54;
	}
	.aln-cu{
		margin-top: -8px;
		margin-bottom: 10px;
		float: none;
	}
	.upd{
		margin-top: -7px;
    	/* float: right; */
    	order: 1;
    	float: right;
	}
	.downd{
		/* float: left; */
		margin-top: 0px;
		order: 2;
		float: right;
	}
	@media screen and (max-width: 480px){
		.aln-cu{
		margin-top: 8px;
	}
	.upd{
		col-md-1;
		order: 1;
	}	
	.downd{
	col-md-11;
		margin-top: -10px;
	}
	}
	@media screen and (max-width: 768px){
		.upd{
			margin-right: 15px;
		}
		.mob-nm{
			margin-left: 3px;
		}
		.padding-device {
		    padding-right: 20px !important;		   
		}
	}
	
	@-webkit-keyframes heartbeat {
	  0% {
	    -webkit-transform:scale(1)
	  }
	  50% {
	    -webkit-transform:scale(1.4)
	  }
	  100% {
	    -webkit-transform:scale(1)
	  }
	}

	@-moz-keyframes heartbeat {
	  0% {
	    -moz-transform:scale(1)
	  }
	  50% {
	    -moz-transform:scale(1.4)
	  }
	  100% {
	    -moz-transform:scale(1)
	  }
	}

	@-o-keyframes heartbeat {
	  0% {
	    -o-transform:scale(1)
	  }
	  50% {
	    -o-transform:scale(1.4)
	  }
	  100% {
	    -o-transform:scale(1)
	  }
	}

	@keyframes heartbeat {
	  0% {
	    transform:scale(1)
	  }
	  50% {
	    transform:scale(1.4)
	  }
	  100% {
	    transform:scale(1)
	  }
	}

	.heartbeat {
	  -webkit-animation-name: heartbeat;
	  -moz-animation-name: heartbeat;
	  -o-animation-name: heartbeat;
	  animation-name: heartbeat;
	}
	
	.animate-infinite-heartbeat {
	  -webkit-animation: heartbeat 2s infinite;
	  animation: heartbeat 2s infinite;
	}
</style>
{{/partial}}

{{>qubercomm/nav-top}}
{{>qubercomm/nav-left}}
{{>qubercomm/wrapper}}